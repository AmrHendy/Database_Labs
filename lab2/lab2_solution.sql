CREATE SCHEMA LIBRARY;

USE LIBRARY;

CREATE TABLE LIBRARY_BRANCH(
	BRANCH_ID INT,
    BRANCH_NAME VARCHAR(50),
    ADDRESS VARCHAR(50),
    
    PRIMARY KEY (BRANCH_ID)

);

CREATE TABLE BORROWER(
	CARD_NO INT,
    B_NAME VARCHAR(50),
    ADDRESS VARCHAR(50),
    PHONE VARCHAR(50),
    
    PRIMARY KEY(CARD_NO)
);

CREATE TABLE PUBLISHER(
	P_NAME VARCHAR(50),
    ADDRESS VARCHAR(50),
    PHONE VARCHAR(50),
    
    PRIMARY KEY(P_NAME)
);



CREATE TABLE BOOK(
	BOOK_ID INT,
    TITLE VARCHAR(50),
    PUBLISHER_NAME VARCHAR(50),
    
    PRIMARY KEY (BOOK_ID),
	FOREIGN KEY (PUBLISHER_NAME) REFERENCES PUBLISHER(P_NAME)
    
);

CREATE TABLE BOOK_AUTHORS(
	BOOK_ID INT,
    AUTHOR_NAME VARCHAR(50),
    
    PRIMARY KEY (BOOK_ID, AUTHOR_NAME),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID)
);




CREATE TABLE BOOK_COPIES(
	BOOK_ID INT,
    BRANCH_ID INT,
    NO_OF_COPIES INT,
    
    PRIMARY KEY (BOOK_ID, BRANCH_ID),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID),
    FOREIGN KEY (BRANCH_ID) REFERENCES LIBRARY_BRANCH(BRANCH_ID)
);

CREATE TABLE BOOK_lOANS(
	BOOK_ID INT,
    BRANCH_ID INT,
    CARD_NO INT,
    DATE_OUT VARCHAR(50),
    DUE_DATE VARCHAR(50),
    
    PRIMARY KEY (BOOK_ID, BRANCH_ID, CARD_NO),
	FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID),
    FOREIGN KEY (BRANCH_ID) REFERENCES LIBRARY_BRANCH(BRANCH_ID),
    FOREIGN KEY (CARD_NO) REFERENCES BORROWER(CARD_NO)
);



INSERT INTO LIBRARY_BRANCH VALUES (1, 'sharpstown', 'san fransisco');
INSERT INTO LIBRARY_BRANCH VALUES (2, 'central', 'san diego');



INSERT INTO BORROWER VALUES (1, 'ahmed', 'san fransisco', '012345677');
INSERT INTO BORROWER VALUES (2, 'mohamed', 'san diego', '012345676');


INSERT INTO PUBLISHER values ('pearson', 'calibmia', '012345678');
INSERT INTO PUBLISHER values ('mcgrawhill', 'texas', '010101010');


INSERT INTO BOOK values (1, 'the lost name', 'pearson');
INSERT INTO BOOK values (2, 'databasesystem', 'mcgrawhill');



INSERT INTO BOOK_AUTHORS values (1, 'stephen king');
INSERT INTO BOOK_AUTHORS values (2, 'elmasry');
INSERT INTO BOOK_AUTHORS values (2, 'stephen king');


INSERT INTO BOOK_COPIES values (1,1,15);
INSERT INTO BOOK_COPIES values (1,2,20);
INSERT INTO BOOK_COPIES values (2,1,14);
INSERT INTO BOOK_COPIES values (2,2,12);


INSERT INTO BOOK_LOANS VALUES (1, 1, 1, '2018-2-26', '2018-3-10');
INSERT INTO BOOK_LOANS VALUES (1, 2, 1, '2018-2-27', '2018-3-9');
INSERT INTO BOOK_LOANS VALUES (2, 1, 2, '2018-2-26', '2018-3-10');
INSERT INTO BOOK_LOANS VALUES (2, 2, 2, '2018-2-27', '2018-3-9');







